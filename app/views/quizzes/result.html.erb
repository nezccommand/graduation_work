<div class="max-w-7xl mx-auto px-4">
  <h2 class="text-2xl sm:text-4xl text-green-900 font-bold mb-6 text-center border-b border-green-300 pb-4">結果発表</h2>

  <div class="mb-8 text-center text-3xl font-extrabold text-green-900 bg-green-100 border border-green-300 rounded-lg py-4 shadow-md">
    <span><%= @total_count %>問中</span>
    <span class="text-green-700"><%= @correct_count %>問</span>
    <span>正解しました！🎉</span>
  </div>

  <div class="mb-8 p-4 border rounded bg-green-50 text-green-900">
    <h3 class="text-xl font-bold mb-2">ジャンル別正答率</h3>

    <ul class="space-y-2">
      <% @genre_accuracies.each do |genre, accuracy| %>
        <li>
          <span class="font-semibold"><%= genre %>：</span>
          <span><%= accuracy %>％</span>
        </li>
      <% end %>
    </ul>

    <% if @weakest_genre.present? %>
      <p class="mt-4 text-red-700 font-semibold">
        あなたは<strong><%= @weakest_genre %></strong>の問題が比較的苦手なようです。
      </p>
    <% end %>
  </div>

  <% @result.each_with_index do |res, i| %>
    <% is_correct_answer = (res[:selected] == res[:correct]) %>

    <div class="mb-10 p-4 border border-gray-200 rounded-lg shadow-sm">
      <h3 class="text-2xl font-semibold mb-2 flex items-center space-x-3">
        <span>第<%= i + 1 %>問</span>
        <% if is_correct_answer %>
          <span class="text-green-800 bg-green-200 px-2 py-1 rounded text-sm font-bold">正解</span>
        <% else %>
          <span class="text-red-800 bg-red-200 px-2 py-1 rounded text-sm font-bold">不正解</span>
        <% end %>
      </h3>

      <p class="mt-6 mb-4 text-xl font-bold"><%= res[:question] %></p>

      <%= render partial: "choice_list", locals: { choices: res[:choices], selected: res[:selected], correct: res[:correct] } %>

      <%= render partial: "toggle_explanation", locals: { explanation: res[:explanation], index: i } %>
    </div>
  <% end %>

  <div class="mt-10 text-center">
    <%= link_to "トップに戻る", root_path, class: "bg-green-700 text-white px-6 py-3 rounded-lg shadow hover:bg-green-600 transition font-semibold" %>
  </div>
</div>